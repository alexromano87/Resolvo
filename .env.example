# =============================================================================
# Resolvo - Environment Variables Template
# =============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env file to git (it's in .gitignore)
# =============================================================================

# -----------------------------------------------------------------------------
# Application Environment
# -----------------------------------------------------------------------------
NODE_ENV=development
# Options: development, production, staging

# -----------------------------------------------------------------------------
# Backend Configuration
# -----------------------------------------------------------------------------
BACKEND_PORT=3000

# JWT Configuration
JWT_SECRET=your-secret-jwt-key-min-32-characters-long
# Generate with: openssl rand -base64 64

JWT_REFRESH_SECRET=your-secret-jwt-refresh-key-min-32-characters-long
# Generate with: openssl rand -base64 64

JWT_EXPIRES_IN=24h
# Access token expiration (e.g., 15m, 1h, 24h)

JWT_REFRESH_EXPIRES_IN=7d
# Refresh token expiration (e.g., 7d, 30d)

# CORS Configuration
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:5173,http://localhost:3001,http://127.0.0.1:5173

# -----------------------------------------------------------------------------
# Database Configuration (MySQL/MariaDB)
# -----------------------------------------------------------------------------
DB_HOST=mysql
DB_PORT=3306
DB_DATABASE=recupero_crediti
DB_USERNAME=rc_user
DB_PASSWORD=rc_pass

# Root password for database (needed for Docker initialization)
MYSQL_ROOT_PASSWORD=root!

# Database Encryption (for production)
# Note: Requires MySQL Enterprise or Percona Server with encryption plugin
DB_ENCRYPTION_ENABLED=false
# Enable encryption at rest (requires database support)

DB_ENCRYPTION_KEY_FILE=
# Path to encryption key file (if using file-based encryption)

# -----------------------------------------------------------------------------
# Frontend Configuration
# -----------------------------------------------------------------------------
FRONTEND_PORT=5173

# Backend API URL (leave empty for auto-detection based on environment)
# In development: http://localhost:3000
# In production: https://your-domain.com/api
VITE_API_URL=

# -----------------------------------------------------------------------------
# Health Check Configuration
# -----------------------------------------------------------------------------
HEALTH_CHECK_INTERVAL=30000
# Interval in milliseconds (default: 30 seconds)

# -----------------------------------------------------------------------------
# Backup Configuration
# -----------------------------------------------------------------------------
BACKUP_SCHEDULE_INTERVAL=86400000
# Backup interval in milliseconds (default: 86400000 = 24 hours)

BACKUP_MAX_COUNT=30
# Maximum number of backups to retain (older backups are automatically deleted)

# -----------------------------------------------------------------------------
# Rate Limiting (Redis-based)
# -----------------------------------------------------------------------------
RATE_LIMIT_TTL=60000
# Time window in milliseconds (default: 60000 = 1 minute)

RATE_LIMIT_MAX=100
# Maximum requests per window (default: 100 for production security)
# Development: 100-200 req/min
# Production: 100 req/min recommended
# E2E Testing: increase to 500-1000 if needed

# Endpoint-specific limits (configured in code):
# - Login: 5 req/min (brute-force protection)
# - Password reset: 3 req/15min
# - Backup create: 5 req/hour
# - Backup restore: 3 req/hour
# - Backup delete: 10 req/hour
# - Export data: 10 req/hour
# - Import data: 5 req/hour

# -----------------------------------------------------------------------------
# Security Headers
# -----------------------------------------------------------------------------
ENABLE_HELMET=true
# Enable Helmet security headers (recommended for production)

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=info
# Options: error, warn, info, debug, verbose

LOG_TO_FILE=false
# Enable file logging (logs/error.log, logs/combined.log)

# -----------------------------------------------------------------------------
# Monitoring & Performance
# -----------------------------------------------------------------------------
# Sentry Error Tracking
SENTRY_DSN=
# Get from: https://sentry.io/settings/your-org/projects/your-project/keys/
# Example: https://abc123@o123456.ingest.sentry.io/987654

SENTRY_ENVIRONMENT=development
# Environment name for Sentry (development, staging, production)

SENTRY_RELEASE=
# Release version (optional, defaults to package.json version)

SENTRY_SEND_IN_DEV=false
# Send errors to Sentry in development (default: false)

SENTRY_TRACES_SAMPLE_RATE=0.1
# % of transactions to trace (0.0-1.0, default: 0.1 = 10%)

SENTRY_PROFILES_SAMPLE_RATE=0.05
# % of transactions to profile (0.0-1.0, default: 0.05 = 5%)

ENABLE_PERFORMANCE_MONITORING=true
# Enable system metrics collection

SLOW_OPERATION_MS=1000
# Log warning if operation takes longer than this (ms)

SLOW_QUERY_MS=1000
# Log warning if database query takes longer than this (ms)

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
# Leave empty if no password is set (default for local development)

# -----------------------------------------------------------------------------
# Email Configuration (SMTP)
# -----------------------------------------------------------------------------
SMTP_HOST=
# Example: smtp.gmail.com, smtp.sendgrid.net, smtp.mailgun.org

SMTP_PORT=587
# Common ports: 25 (insecure), 587 (TLS), 465 (SSL)

SMTP_SECURE=false
# Use SSL/TLS (true for port 465, false for port 587)

SMTP_USER=
# SMTP username (usually your email address)

SMTP_PASSWORD=
# SMTP password or app-specific password

SMTP_FROM=noreply@yourdomain.com
# Sender email address

# -----------------------------------------------------------------------------
# AWS S3 for Backup Storage (Optional)
# -----------------------------------------------------------------------------
AWS_ACCESS_KEY_ID=
# AWS IAM user access key

AWS_SECRET_ACCESS_KEY=
# AWS IAM user secret key

AWS_REGION=eu-central-1
# AWS region where S3 bucket is located

S3_BACKUP_BUCKET=
# S3 bucket name for backup storage (e.g., resolvo-backups)

# -----------------------------------------------------------------------------
# Backup Retention
# -----------------------------------------------------------------------------
BACKUP_RETENTION_DAYS=30
# Number of days to retain backups before automatic deletion

# =============================================================================
# Production Deployment Notes
# =============================================================================
# SECURITY CHECKLIST:
# 1. Generate secure JWT_SECRET: openssl rand -base64 64
# 2. Use strong database passwords (min 16 characters, mixed case, numbers, symbols)
# 3. Set CORS_ORIGINS to your actual domain(s)
# 4. Enable HTTPS in production (Nginx/reverse proxy)
# 5. Set NODE_ENV=production
# 6. Configure SENTRY_DSN for error tracking
# 7. Set RATE_LIMIT_MAX=100 (or lower for high-security)
#
# INFRASTRUCTURE:
# 8. Configure backup storage to external service (S3, Google Cloud Storage)
# 9. Enable database encryption at rest (use AWS RDS with encryption, or Percona)
# 10. Set up centralized logging (Elasticsearch, CloudWatch, Datadog)
# 11. Configure performance monitoring (Sentry APM, New Relic, Dynatrace)
# 12. Use encrypted volumes for sensitive data
#
# DATABASE ENCRYPTION OPTIONS:
# - AWS RDS: Enable encryption when creating instance
# - Google Cloud SQL: Enable encryption at rest
# - Self-hosted: Use Percona Server with encryption plugin
# - Docker: Mount encrypted volume for /var/lib/mysql
#
# Example Docker encrypted volume:
# docker volume create --driver local \
#   --opt type=tmpfs \
#   --opt device=tmpfs \
#   --opt o=size=10g,encryption=aes-256-gcm \
#   mysql_encrypted_data
# =============================================================================
